"use strict";(self.webpackChunkMediapoint=self.webpackChunkMediapoint||[]).push([[31],{7031:(It,b,a)=>{a.r(b),a.d(b,{QuotesModule:()=>Nt});var _=a(6895),h=a(5453),f=a(5412),p=a(2722),C=a(262),y=a(9673),M=a(7795),g=a(5064),v=a(2893),q=a(2233),x=a(7188),J=a(8672),t=a(1571),D=a(8505),c=a(8760),Y=a(5384),w=a(1438);let O=(()=>{class n{constructor(e,o,s){this.apiService=e,this.authorizationService=o,this.router=s}getQuotes(e){return this.apiService.get((0,c.bC)(this.isAdmin,c.T5.QUOTES)+e)}getQuote(e){return this.apiService.get(c.wY.generate((0,c.bC)(this.isAdmin,c.T5.QUOTES_BY_ID),{quoteId:e}))}getQuotesFilter(){return this.apiService.get((0,c.bC)(this.isAdmin,c.T5.QUOTES_FILTER))}createOrderByQuotes(e){return this.apiService.post((0,c.bC)(this.isAdmin,c.T5.QUOTES_CREATE_ORDER),{selected:e}).pipe((0,D.b)(o=>this.redirectToCartPage(o)))}createOrderByQuotesId(e,o=""){return this.apiService.post(c.wY.generate((0,c.bC)(this.isAdmin,c.T5.QUOTES_CREATE_ORDER_BY_ID),{quoteId:e}),{quoteReference:o}).pipe((0,D.b)(s=>this.redirectToCartPage(s)))}copyQuotes(e){return this.apiService.post((0,c.bC)(this.isAdmin,c.T5.QUOTES_COPY),{selected:e})}copyQuoteById(e){return this.apiService.post(c.wY.generate((0,c.bC)(this.isAdmin,c.T5.QUOTE_COPY_BY_ID),{quoteId:e}))}copyQuoteJob(e){return this.apiService.post(c.wY.generate((0,c.bC)(this.isAdmin,c.T5.QUOTE_JOB_COPY),{jobId:e}))}deleteQuotes(e){return this.apiService.delete((0,c.bC)(this.isAdmin,c.T5.QUOTES),{selected:e})}deleteQuoteById(e){return this.apiService.delete(c.wY.generate((0,c.bC)(this.isAdmin,c.T5.QUOTES_BY_ID),{quoteId:e}))}deleteQuoteJob(e){return this.apiService.delete(c.wY.generate((0,c.bC)(this.isAdmin,c.T5.QUOTE_JOB),{jobId:e}))}getQuotePdf(e){return this.apiService.getBlob(c.wY.generate((0,c.bC)(this.isAdmin,c.T5.QUOTE_PDF),{quoteId:e}))}saveQuoteReference(e,o){return this.apiService.post(c.wY.generate(c.T5.QUOTE_REFERENCE,{cartId:o}),{quoteReference:e})}redirectToCartPage(e){console.log(e),this.router.navigate(["/cart"])}get isAdmin(){return this.authorizationService.isAdmin}}return n.\u0275fac=function(e){return new(e||n)(t.LFG(Y.s),t.LFG(w.Z),t.LFG(h.F0))},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var d=a(4006),R=a(42),P=a(6885),N=a(7268),I=a(8653),U=a(2914),A=a(7758),S=a(605),F=a(2834);function B(n,i){if(1&n&&(t.TgZ(0,"div",22),t._uU(1," Valid Until: "),t.TgZ(2,"span"),t._uU(3),t.ALo(4,"date"),t.qZA()()),2&n){const e=t.oxw(2);t.xp6(3),t.Oqu(t.xi3(4,1,e.quoteData.validUntil,"dd/MM/YY"))}}function j(n,i){if(1&n){const e=t.EpF();t.TgZ(0,"app-options-menu",23),t.NdJ("deleteEvent",function(){t.CHM(e);const s=t.oxw(2);return t.KtG(s.deleteQuote())}),t.qZA()}if(2&n){const e=t.oxw(2);t.Q6J("nameItem","quote")("listOfOptions",e.listOfOptions)}}function L(n,i){if(1&n){const e=t.EpF();t.TgZ(0,"app-job-details-wrap",24),t.NdJ("editEvent",function(s){t.CHM(e);const r=t.oxw(2);return t.KtG(r.editJob(s))})("duplicateEvent",function(s){t.CHM(e);const r=t.oxw(2);return t.KtG(r.duplicateJob(s))})("deleteEvent",function(s){t.CHM(e);const r=t.oxw(2);return t.KtG(r.deleteJob(s))}),t.qZA()}if(2&n){const e=i.$implicit,o=t.oxw(2);t.Q6J("job",e)("price",e.price)("isShowMenu",!o.isAdmin)("listOfOptions",o.listOfOptions)}}function $(n,i){if(1&n&&(t.TgZ(0,"div",25),t._UZ(1,"app-pdf-block",26),t.qZA()),2&n){const e=t.oxw(2);t.xp6(1),t.Q6J("file",e.file)("isDownloadBtn",!0)}}function G(n,i){if(1&n){const e=t.EpF();t.TgZ(0,"div",27)(1,"app-button",28),t.NdJ("clickEvent",function(){t.CHM(e);const s=t.oxw(2);return t.KtG(s.onCreateOrder())}),t.qZA()()}if(2&n){const e=t.oxw(2);t.xp6(1),t.Q6J("buttonConfig",e.buttonConfig)("isLoaded",e.isLoaded)}}function K(n,i){if(1&n){const e=t.EpF();t.TgZ(0,"div",2)(1,"div",3),t._UZ(2,"app-breadcrumbs",4),t.qZA(),t.TgZ(3,"div",5)(4,"div",6)(5,"div",7)(6,"div",8)(7,"div",9),t._uU(8),t.qZA(),t.TgZ(9,"div",10),t._uU(10),t.qZA()(),t.YNc(11,B,5,4,"div",11),t.YNc(12,j,1,2,"ng-template",null,12,t.W1O),t.qZA(),t.TgZ(14,"div",13),t.YNc(15,L,1,4,"app-job-details-wrap",14),t.TgZ(16,"form",15),t.NdJ("ngSubmit",function(){t.CHM(e);const s=t.oxw();return t.KtG(s.saveReference())}),t.TgZ(17,"div",16)(18,"app-field",17),t.NdJ("blurEvent",function(){t.CHM(e);const s=t.oxw();return t.KtG(s.saveReference())}),t.qZA()()(),t.YNc(19,$,2,2,"div",18),t.qZA()(),t.TgZ(20,"div",19),t._UZ(21,"app-price-data",20),t.YNc(22,G,2,2,"div",21),t.qZA()()()}if(2&n){const e=t.MAs(13),o=t.oxw();t.xp6(2),t.Q6J("breadcrumbsData",o.breadcrumbs),t.xp6(6),t.hij("Quote #",o.quoteData.id,""),t.xp6(1),t.Q6J("ngClass",o.toKebabCase(o.quoteData.status)),t.xp6(1),t.hij(" ",o.quoteData.status," "),t.xp6(1),t.Q6J("ngIf",!o.isAdmin)("ngIfElse",e),t.xp6(4),t.Q6J("ngForOf",o.quoteData.jobs),t.xp6(1),t.Q6J("formGroup",o.form),t.xp6(1),t.ekj("disabled",o.isAdmin),t.xp6(1),t.Q6J("control",o.form.controls.reference)("label","Quote Reference")("type",o.FIELD_TYPES.Text)("placeholder","GU81739UUN"),t.xp6(1),t.Q6J("ngIf",o.file),t.xp6(2),t.Q6J("title","Price")("priceDetails",o.quoteData.priceDetails),t.xp6(1),t.Q6J("ngIf",!o.isAdmin)}}function H(n,i){1&n&&t._UZ(0,"app-loader")}let k=(()=>{class n{constructor(e,o,s,r,l,m,T){this.quoteService=e,this.router=o,this.activatedRoute=s,this.destroy$=r,this.dialog=l,this.formBuilder=m,this.ngZone=T,this.toKebabCase=J.m,this.FIELD_TYPES=M.U,this.listOfOptions=[g.m.Delete],this.isLoaded=!0,this.breadcrumbs=[{name:"Quotes",url:"back"},{name:this.activatedRoute.snapshot.params?.id}],this.buttonConfig={text:"Add to cart",viewType:y.F.Filled,minWidth:"100%"},this.dialogSuccessConfig={title:"Success!",isSuccess:!0}}ngOnInit(){this.quoteId=this.activatedRoute.snapshot.params.id,this.getQuoteData(),this.getQuotePdf(),this.isAdmin||this.listOfOptions.unshift(g.m.Edit,g.m.Duplicate)}getQuoteData(){this.quoteService.getQuote(+this.quoteId).pipe((0,p.R)(this.destroy$)).subscribe(e=>{this.quoteData=e,this.initForm()})}getQuotePdf(){this.quoteService.getQuotePdf(this.quoteId).pipe((0,p.R)(this.destroy$)).subscribe(e=>{this.file=new File([e],`Quote-${this.quoteId}.pdf`)})}initForm(){this.form||(this.form=this.formBuilder.group({reference:this.quoteData.quoteReference||""}))}editJob(e){let o=new f.vA;o={...o,width:"100%",maxWidth:"834px",maxHeight:"90vh",data:{title:"Edit the job #"+e,jobId:e}},this.dialog.open(q.a,o).afterClosed().pipe((0,p.R)(this.destroy$)).subscribe(()=>{this.getQuoteData()})}duplicateJob(e){this.quoteService.copyQuoteJob(e).pipe((0,p.R)(this.destroy$)).subscribe(()=>{this.getQuoteData(),this.openSuccessDialog()})}deleteJob(e){this.quoteService.deleteQuoteJob(e).pipe((0,p.R)(this.destroy$)).subscribe(()=>{this.quoteData.jobs=this.quoteData.jobs.filter(o=>o.id!==e),this.quoteData.jobs.length||this.backToPreviousPage()})}deleteQuote(){this.quoteService.deleteQuoteById(this.quoteId).pipe((0,p.R)(this.destroy$)).subscribe(()=>this.backToPreviousPage())}saveReference(){const e=this.form.get("reference")?.value;this.quoteData.quoteReference===e||this.isAdmin||(this.quoteData.quoteReference=e,this.quoteService.saveQuoteReference(e,"Q"+this.quoteId).subscribe(()=>this.openSuccessDialog()))}onCreateOrder(){const e=this.form.get("reference")?.value;this.isLoaded=!1,this.quoteService.createOrderByQuotesId(this.quoteId,e).pipe((0,C.K)(o=>{throw this.isLoaded=!0,o}),(0,p.R)(this.destroy$)).subscribe()}openSuccessDialog(){let e=new f.vA;e={...e,disableClose:!0,width:"100%",maxWidth:"558px",data:this.dialogSuccessConfig},this.dialog.open(x.a,e)}backToPreviousPage(){this.ngZone.run(()=>{this.router.navigate(["../"],{relativeTo:this.activatedRoute})})}get isAdmin(){return this.quoteService.isAdmin}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(O),t.Y36(h.F0),t.Y36(h.gz),t.Y36(v.h),t.Y36(f.uw),t.Y36(d.qu),t.Y36(t.R0b))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-quote-details"]],features:[t._Bn([v.h])],decls:3,vars:2,consts:[["class","quote",4,"ngIf","ngIfElse"],["loading",""],[1,"quote"],[1,"breadcrumbs"],[3,"breadcrumbsData"],[1,"grid-container"],[1,"grid-container__main","quote"],[1,"quote_top"],[1,"title"],[1,"title-main"],[1,"status-label",3,"ngClass"],["class","term",4,"ngIf","ngIfElse"],["menu",""],[1,"app-block"],[3,"job","price","isShowMenu","listOfOptions","editEvent","duplicateEvent","deleteEvent",4,"ngFor","ngForOf"],[1,"form",3,"formGroup","ngSubmit"],[1,"field"],["formControlName","reference",3,"control","label","type","placeholder","blurEvent"],["class","pdf",4,"ngIf"],[1,"grid-container__sidebar","price","fixed"],[3,"title","priceDetails"],["class","button",4,"ngIf"],[1,"term"],[3,"nameItem","listOfOptions","deleteEvent"],[3,"job","price","isShowMenu","listOfOptions","editEvent","duplicateEvent","deleteEvent"],[1,"pdf"],[3,"file","isDownloadBtn"],[1,"button"],[3,"buttonConfig","isLoaded","clickEvent"]],template:function(e,o){if(1&e&&(t.YNc(0,K,23,18,"div",0),t.YNc(1,H,1,0,"ng-template",null,1,t.W1O)),2&e){const s=t.MAs(2);t.Q6J("ngIf",o.quoteData)("ngIfElse",s)}},dependencies:[_.mk,_.sg,_.O5,R.r,P.C,d._Y,d.JJ,d.JL,d.sg,d.u,N.w,I.o,U.D,A.N,S.R,F.n,_.uU],styles:["[_ngcontent-%COMP%]:root{--header-height: 180px}.quote_top[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;margin:0 24px 17px 0}.quote_top[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{display:flex;align-items:center}.quote_top[_ngcontent-%COMP%]   .status-label[_ngcontent-%COMP%]{margin-left:8px}.quote[_ngcontent-%COMP%]   .app-block[_ngcontent-%COMP%]{padding:16px 24px}.quote[_ngcontent-%COMP%]   .form[_ngcontent-%COMP%]{margin-top:20px}.quote[_ngcontent-%COMP%]   .field.disabled[_ngcontent-%COMP%]{pointer-events:none}.quote[_ngcontent-%COMP%]   .pdf[_ngcontent-%COMP%]{margin-top:20px}.quote[_ngcontent-%COMP%]   .price[_ngcontent-%COMP%]{margin-top:45px}.quote[_ngcontent-%COMP%]   .price[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]{margin-top:22px}"]}),n})();var z=a(9418),W=a(3364),V=a(2686),X=a(4732),tt=a(3184),u=a(7155),Z=a(6709),Q=a(6308),E=a(1581),et=a(7125),nt=a(5216),ot=a(9727),it=a(8348),st=a(7499);function at(n,i){if(1&n){const e=t.EpF();t.TgZ(0,"img",17),t.NdJ("click",function(){t.CHM(e);const s=t.oxw(2);return t.KtG(s.onCreateOrder())}),t.qZA()}2&n&&t.Q6J("tooltip","Add to new order")}function ct(n,i){if(1&n){const e=t.EpF();t.TgZ(0,"div",11)(1,"div",12),t._uU(2),t.qZA(),t.TgZ(3,"div",13),t.YNc(4,at,1,1,"img",14),t.TgZ(5,"img",15),t.NdJ("click",function(){t.CHM(e);const s=t.oxw();return t.KtG(s.onDuplicate())}),t.qZA(),t.TgZ(6,"img",16),t.NdJ("click",function(){t.CHM(e);const s=t.oxw();return t.KtG(s.onDelete())}),t.qZA()()()}if(2&n){const e=t.oxw();t.xp6(2),t.hij(" Selected items: ",e.selection.selected.length," "),t.xp6(2),t.Q6J("ngIf",!e.isAdmin),t.xp6(1),t.Q6J("tooltip","Duplicate"),t.xp6(1),t.Q6J("tooltip","Delete")}}function rt(n,i){if(1&n){const e=t.EpF();t.TgZ(0,"th",37)(1,"mat-checkbox",38),t.NdJ("change",function(s){t.CHM(e);const r=t.oxw(3);return t.KtG(s?r.toggleAllRows():null)}),t.qZA()()}if(2&n){const e=t.oxw(3);t.xp6(1),t.Q6J("checked",e.selection.hasValue()&&e.isAllSelected())("indeterminate",e.selection.hasValue()&&!e.isAllSelected())}}function lt(n,i){if(1&n){const e=t.EpF();t.TgZ(0,"td",39)(1,"mat-checkbox",40),t.NdJ("click",function(s){return s.stopPropagation()})("change",function(s){const l=t.CHM(e).$implicit,m=t.oxw(3);return t.KtG(s?m.selection.toggle(l.id):null)}),t.qZA()()}if(2&n){const e=i.$implicit,o=t.oxw(3);t.xp6(1),t.Q6J("checked",o.selection.isSelected(e.id))}}function pt(n,i){1&n&&(t.TgZ(0,"th",41),t._uU(1," Quote number "),t.qZA())}function ut(n,i){if(1&n&&(t.TgZ(0,"td",39),t._uU(1),t.qZA()),2&n){const e=i.$implicit;t.xp6(1),t.Oqu(e.id)}}function _t(n,i){1&n&&(t.TgZ(0,"th",41),t._uU(1," Quote Reference "),t.qZA())}function dt(n,i){if(1&n){const e=t.EpF();t.TgZ(0,"td",39)(1,"input",42,43),t.NdJ("keyup.enter",function(){t.CHM(e);const s=t.MAs(2);return t.KtG(s.blur())})("blur",function(){const r=t.CHM(e).$implicit,l=t.MAs(2),m=t.oxw(3);return t.KtG(m.saveReference(r,l.value))}),t.qZA()()}if(2&n){const e=i.$implicit,o=t.oxw(3);t.xp6(1),t.ekj("disabled",o.isAdmin),t.Q6J("ngModel",e.quoteReference)}}function mt(n,i){1&n&&(t.TgZ(0,"th",41),t._uU(1," Quote Date "),t.qZA())}function gt(n,i){if(1&n&&(t.TgZ(0,"td",39),t._uU(1),t.ALo(2,"date"),t.qZA()),2&n){const e=i.$implicit;t.xp6(1),t.hij(" ",t.xi3(2,1,e.createdAt,"dd/MM/YY")," ")}}function ht(n,i){1&n&&(t.TgZ(0,"th",41),t._uU(1," Valid Until "),t.qZA())}function ft(n,i){if(1&n&&(t.TgZ(0,"td",39),t._uU(1),t.ALo(2,"date"),t.qZA()),2&n){const e=i.$implicit;t.xp6(1),t.hij(" ",t.xi3(2,1,e.validUntil,"dd/MM/YY")," ")}}function Ct(n,i){1&n&&(t.TgZ(0,"th",41),t._uU(1," Created by "),t.qZA())}function vt(n,i){if(1&n&&(t.TgZ(0,"td",39),t._uU(1),t.qZA()),2&n){const e=i.$implicit;t.xp6(1),t.Oqu(e.createdBy)}}function xt(n,i){1&n&&(t.TgZ(0,"th",41),t._uU(1,"Price"),t.qZA())}function Qt(n,i){if(1&n&&(t.TgZ(0,"td",39),t._uU(1),t.ALo(2,"currency"),t.qZA()),2&n){const e=i.$implicit;t.xp6(1),t.hij(" ",t.lcZ(2,1,e.price)," ")}}function Tt(n,i){1&n&&(t.TgZ(0,"th",41),t._uU(1,"Status"),t.qZA())}function bt(n,i){if(1&n&&(t.TgZ(0,"td",39)(1,"span",44),t._uU(2),t.qZA()()),2&n){const e=i.$implicit,o=t.oxw(3);t.xp6(1),t.Q6J("ngClass",o.toKebabCase(e.status)),t.xp6(1),t.hij(" ",e.status," ")}}function Dt(n,i){1&n&&t._UZ(0,"th",45)}function Ot(n,i){if(1&n){const e=t.EpF();t.TgZ(0,"td",39)(1,"div",46)(2,"app-options-menu",47),t.NdJ("duplicateEvent",function(){const r=t.CHM(e).$implicit,l=t.oxw(3);return t.KtG(l.onDuplicate(r.id))})("addToCartEvent",function(){const r=t.CHM(e).$implicit,l=t.oxw(3);return t.KtG(l.onCreateOrder(r.id))})("deleteEvent",function(){const r=t.CHM(e).$implicit,l=t.oxw(3);return t.KtG(l.onDelete(r.id))}),t.qZA()()()}if(2&n){const e=t.oxw(3);t.xp6(2),t.Q6J("nameItem","quote")("listOfOptions",e.listOfOptions)}}function At(n,i){1&n&&t._UZ(0,"tr",48)}const St=function(n){return{selected:n}};function Zt(n,i){if(1&n){const e=t.EpF();t.TgZ(0,"tr",49),t.NdJ("mouseup",function(s){const l=t.CHM(e).$implicit,m=t.oxw(3);return t.KtG(m.goToDetailsPage(s,l.id))}),t.qZA()}if(2&n){const e=i.$implicit,o=t.oxw(3);t.Q6J("ngClass",t.VKq(1,St,o.selection.isSelected(e.id)))}}const Et=function(){return[5,10,20]};function yt(n,i){if(1&n){const e=t.EpF();t.TgZ(0,"mat-paginator",50),t.NdJ("page",function(s){t.CHM(e);const r=t.oxw(3);return t.KtG(r.onChangePage(s))}),t.qZA()}if(2&n){const e=t.oxw(3);t.Q6J("length",e.totalItems)("pageSize",e.params.perPage)("pageSizeOptions",t.DdM(4,Et))("pageIndex",e.params.currentPage-1)}}function Mt(n,i){if(1&n){const e=t.EpF();t.ynx(0),t.TgZ(1,"div",19)(2,"table",20),t.NdJ("matSortChange",function(s){t.CHM(e);const r=t.oxw(2);return t.KtG(r.sortData(s))}),t.ynx(3,21),t.YNc(4,rt,2,2,"th",22),t.YNc(5,lt,2,1,"td",23),t.BQk(),t.ynx(6,24),t.YNc(7,pt,2,0,"th",25),t.YNc(8,ut,2,1,"td",23),t.BQk(),t.ynx(9,26),t.YNc(10,_t,2,0,"th",25),t.YNc(11,dt,3,3,"td",23),t.BQk(),t.ynx(12,27),t.YNc(13,mt,2,0,"th",25),t.YNc(14,gt,3,4,"td",23),t.BQk(),t.ynx(15,28),t.YNc(16,ht,2,0,"th",25),t.YNc(17,ft,3,4,"td",23),t.BQk(),t.ynx(18,29),t.YNc(19,Ct,2,0,"th",25),t.YNc(20,vt,2,1,"td",23),t.BQk(),t.ynx(21,30),t.YNc(22,xt,2,0,"th",25),t.YNc(23,Qt,3,3,"td",23),t.BQk(),t.ynx(24,31),t.YNc(25,Tt,2,0,"th",25),t.YNc(26,bt,3,2,"td",23),t.BQk(),t.ynx(27,32),t.YNc(28,Dt,1,0,"th",33),t.YNc(29,Ot,3,2,"td",23),t.BQk(),t.YNc(30,At,1,0,"tr",34),t.YNc(31,Zt,1,3,"tr",35),t.qZA(),t.YNc(32,yt,1,5,"mat-paginator",36),t.qZA(),t.BQk()}if(2&n){const e=t.oxw(2);t.xp6(1),t.ekj("block-disabled",!e.isLoaded),t.xp6(1),t.Q6J("dataSource",e.dataSource),t.xp6(28),t.Q6J("matHeaderRowDef",e.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",e.displayedColumns),t.xp6(1),t.Q6J("ngIf",e.totalItems>e.params.perPage)}}function qt(n,i){if(1&n&&t._UZ(0,"app-no-results",51),2&n){const e=t.oxw(2);t.Q6J("isSearch",e.isSearch)("noResultsText","You don't have quotes yet")}}function Jt(n,i){if(1&n&&(t.ynx(0),t.YNc(1,Mt,33,6,"ng-container",9),t.YNc(2,qt,1,2,"ng-template",null,18,t.W1O),t.BQk()),2&n){const e=t.MAs(3),o=t.oxw();t.xp6(1),t.Q6J("ngIf",o.dataSource.data.length)("ngIfElse",e)}}function Yt(n,i){1&n&&t._UZ(0,"app-loader")}const wt=[{path:"",component:(()=>{class n extends tt.O{constructor(e,o,s,r,l,m,T){super(e,o,s,r,l),this.quoteService=m,this.dialog=T,this.displayedColumns=["select","id","quoteReference","createdAt","validUntil","createdBy","price","status"],this.listOfOptions=[],this.filterConfig={isLoaded:!1,isFilterStatus:!0,statuses:(0,X.c)(W.NW),isFilterDate:!0,isSizeRange:!0,isQuantity:!0,isFilterPrise:!0},this.dialogDeleteConfig={title:"Delete quote?",message:"Are you sure?",declineButtonText:"Cancel",acceptButtonText:"Delete"},this.dialogSuccessConfig={title:"Success!",isSuccess:!0}}getData(){this.quoteService.getQuotes((0,V.f)(this.params)).pipe((0,p.R)(this.destroy$)).subscribe(e=>{this.setData(e),this.initTable()})}initTable(){!this.isAdmin||this.displayedColumns.includes("menu")||(this.displayedColumns=[...this.displayedColumns,"menu"],this.listOfOptions=this.isAdmin?[g.m.Duplicate,g.m.Delete]:[g.m.Duplicate,g.m.AddToCart,g.m.Delete])}getFilter(){this.quoteService.getQuotesFilter().pipe((0,p.R)(this.destroy$)).subscribe(e=>{this.setFilter(e)})}onCreateOrder(e){this.isLoaded=!1,e?this.quoteService.createOrderByQuotesId(e).subscribe():this.quoteService.createOrderByQuotes(this.selection.selected).pipe((0,C.K)(o=>{throw this.isLoaded=!0,o}),(0,p.R)(this.destroy$)).subscribe()}onDuplicate(e){this.isLoaded=!1,(e?this.quoteService.copyQuoteById(e):this.quoteService.copyQuotes(this.selection.selected)).pipe((0,C.K)(o=>{throw this.isLoaded=!0,o}),(0,p.R)(this.destroy$)).subscribe(()=>{this.getData(),this.openSuccessDialog(),this.selection.clear(),this.isLoaded=!0})}saveReference(e,o){e.quoteReference===o||this.isAdmin||(e.quoteReference=o,this.quoteService.saveQuoteReference(o,"Q"+e.id).subscribe(()=>this.openSuccessDialog()))}openSuccessDialog(){let e=new f.vA;e={...e,disableClose:!0,width:"100%",maxWidth:"558px",data:this.dialogSuccessConfig},this.dialog.open(x.a,e)}onDelete(e){e?this.deleteQuotes(e):this.openDeleteDialog()}deleteQuotes(e){this.isLoaded=!1,(e?this.quoteService.deleteQuoteById(e):this.quoteService.deleteQuotes(this.selection.selected)).pipe((0,C.K)(o=>{throw this.isLoaded=!0,o}),(0,p.R)(this.destroy$)).subscribe(()=>{this.getData(),this.selection.clear(),this.isLoaded=!0})}openDeleteDialog(){let e=new f.vA;this.dialogDeleteConfig.title="Delete quote"+(this.selection.selected.length>1?"s?":"?"),e={...e,disableClose:!0,width:"100%",maxWidth:"558px",data:this.dialogDeleteConfig},this.dialog.open(x.a,e).afterClosed().pipe((0,p.R)(this.destroy$)).subscribe(s=>{s===z.u.Accept&&this.deleteQuotes()})}get isAdmin(){return this.quoteService.isAdmin}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(h.F0),t.Y36(h.gz),t.Y36(v.h),t.Y36(t.sBO),t.Y36(t.R0b),t.Y36(O),t.Y36(f.uw))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-quotes"]],features:[t._Bn([v.h]),t.qOj],decls:13,vars:6,consts:[[1,"quotes","wrap"],[1,"title-main"],[1,"top"],[1,"top__search"],[3,"placeholder","searchEvent"],[1,"top__filter"],[3,"setFilterConfig","searchEvent"],[3,"setFilterLabels","clearLabelsEvent"],["class","selected-block",4,"ngIf"],[4,"ngIf","ngIfElse"],["loading",""],[1,"selected-block"],[1,"selected-item"],[1,"buttons"],["src","./assets/images/icons/basket.svg","alt","Add to new order",3,"tooltip","click",4,"ngIf"],["src","./assets/images/icons/copy.svg","alt","Duplicate",3,"tooltip","click"],["src","./assets/images/icons/trash-black.svg","alt","Delete",3,"tooltip","click"],["src","./assets/images/icons/basket.svg","alt","Add to new order",3,"tooltip","click"],["noResults",""],[1,"table-wrap"],["mat-table","","matSort","",1,"table",3,"dataSource","matSortChange"],["matColumnDef","select"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","id"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["matColumnDef","quoteReference"],["matColumnDef","createdAt"],["matColumnDef","validUntil"],["matColumnDef","createdBy"],["matColumnDef","price"],["matColumnDef","status"],["matColumnDef","menu"],["mat-header-cell","","class","small",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",3,"ngClass","mouseup",4,"matRowDef","matRowDefColumns"],[3,"length","pageSize","pageSizeOptions","pageIndex","page",4,"ngIf"],["mat-header-cell",""],[3,"checked","indeterminate","change"],["mat-cell",""],[3,"checked","click","change"],["mat-header-cell","","mat-sort-header",""],["type","text","placeholder","\u2014",1,"input","btn",3,"ngModel","keyup.enter","blur"],["input",""],[1,"status-label",3,"ngClass"],["mat-header-cell","",1,"small"],[1,"menu"],[3,"nameItem","listOfOptions","duplicateEvent","addToCartEvent","deleteEvent"],["mat-header-row",""],["mat-row","",3,"ngClass","mouseup"],[3,"length","pageSize","pageSizeOptions","pageIndex","page"],[3,"isSearch","noResultsText"]],template:function(e,o){if(1&e&&(t.TgZ(0,"div",0)(1,"div",1),t._uU(2,"Quotes"),t.qZA(),t.TgZ(3,"div",2)(4,"div",3)(5,"app-search",4),t.NdJ("searchEvent",function(r){return o.searchByText(r)}),t.qZA()(),t.TgZ(6,"div",5)(7,"app-filter",6),t.NdJ("searchEvent",function(r){return o.searchByFilters(r)}),t.qZA()()(),t.TgZ(8,"app-filter-labels",7),t.NdJ("clearLabelsEvent",function(r){return o.searchByFilters(r)}),t.qZA(),t.YNc(9,ct,7,4,"div",8),t.YNc(10,Jt,4,2,"ng-container",9),t.YNc(11,Yt,1,0,"ng-template",null,10,t.W1O),t.qZA()),2&e){const s=t.MAs(12);t.xp6(5),t.Q6J("placeholder","Type PO number, Job number or any other data..."),t.xp6(2),t.Q6J("setFilterConfig",o.filterConfig),t.xp6(1),t.Q6J("setFilterLabels",o.filterLabels),t.xp6(1),t.Q6J("ngIf",o.selection.selected.length),t.xp6(1),t.Q6J("ngIf",o.isDataLoaded)("ngIfElse",s)}},dependencies:[_.mk,_.O5,u.BZ,u.fO,u.as,u.w1,u.Dz,u.nj,u.ge,u.ev,u.XQ,u.Gk,Z.oG,Q.YE,Q.nU,E.NW,et.i,d.Fj,d.JJ,d.On,nt.S,ot.g,it.z,st.j,A.N,S.R,_.H9,_.uU],styles:["[_ngcontent-%COMP%]:root{--header-height: 180px}.wrap[_ngcontent-%COMP%]   .top[_ngcontent-%COMP%]{display:flex;justify-content:space-between;column-gap:20px;padding-bottom:24px}.wrap[_ngcontent-%COMP%]   .top__search[_ngcontent-%COMP%]{flex:1}.wrap[_ngcontent-%COMP%]   .input[_ngcontent-%COMP%]{height:44px;width:95%;margin-bottom:-1px;border-color:transparent;color:#5a5c81;background:transparent;transition:.3s ease-in}.wrap[_ngcontent-%COMP%]   .input.disabled[_ngcontent-%COMP%]{pointer-events:none}.wrap[_ngcontent-%COMP%]   .input[_ngcontent-%COMP%]:focus{border-bottom:1px solid #c5c5c5}.wrap[_ngcontent-%COMP%]   .input[_ngcontent-%COMP%]::placeholder{color:#5a5c81}",".title-main[_ngcontent-%COMP%]{margin-bottom:32px}"]}),n})(),pathMatch:"full"},{path:":id",component:k}];let Rt=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[h.Bz.forChild(wt),h.Bz]}),n})();var Pt=a(4466);let Nt=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[_.ez,Rt,u.p0,Z.p9,Q.JX,E.TU,Pt.m]}),n})()}}]);